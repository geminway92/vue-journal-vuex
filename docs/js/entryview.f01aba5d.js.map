{"version":3,"sources":["webpack:///./src/modules/daybook/views/EntryView.vue?7733","webpack:///./src/modules/daybook/views/EntryView.vue","webpack:///./src/modules/daybook/helpers/getDayMonthYear.js","webpack:///./src/modules/daybook/helpers/uploadImage.js","webpack:///./src/modules/daybook/views/EntryView.vue?9037"],"names":["class","entry","day","month","yearDay","type","onSelectedImage","ref","accept","id","onDeleteEntry","onSelectImage","text","placeholder","picture","src","alt","localImage","icon","saveEntry","months","days","getDayMonthYear","dateString","date","Date","getDate","getMonth","getFullYear","getDay","uploadImage","file","formData","FormData","append","url","axios","post","data","secure_url","console","error","log","props","String","required","name","components","Fab","computed","this","methods","loadEntry","getTime","getEntryById","$router","push","fire","title","allowOutsideClick","showLoading","updateEntry","createEntry","params","showDenyButton","confirmButtonText","isConfirmed","deleteEntry","event","target","files","fr","FileReader","onload","result","readAsDataURL","$refs","imageSelector","click","created","watch","render","__scopeId"],"mappings":"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","file":"js/entryview.f01aba5d.js","sourcesContent":["export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./EntryView.vue?vue&type=style&index=0&id=0dd55433&lang=scss&scoped=true\"","<template>\r\n  <template v-if=\"entry\">\r\n    <div class=\"entry-title d-flex justify-content-between p-2\">\r\n      <div>\r\n        <span class=\"text-success fs-3 fw-bold\">{{ day }}</span>\r\n        <span class=\"mx-1 fs-3\">{{ month }}</span>\r\n        <span class=\"mx-2 fs-4 fw-light\">{{ yearDay }}</span>\r\n      </div>\r\n\r\n      <div>\r\n        <input\r\n          type=\"file\"\r\n          @change=\"onSelectedImage\"\r\n          ref=\"imageSelector\"\r\n          v-show=\"false\"                   \r\n          accept=\"image/png, image/jpg\"> \r\n\r\n        <button \r\n          v-if=\"entry.id\"\r\n          class=\"btn btn-danger mx-2\"\r\n          @click=\"onDeleteEntry\">\r\n          Borrar\r\n          <i class=\"fa fa-trash-alt\"></i>\r\n        </button>\r\n\r\n        <button class=\"btn btn-primary\"\r\n          @click=\"onSelectImage\">\r\n          Subir foto\r\n          <i class=\"fa fa-upload\"></i>\r\n        </button>\r\n      </div>\r\n    </div>\r\n\r\n    <hr />\r\n    <div class=\"d-flex flex-column px-3 h-75\">\r\n      <textarea v-model=\"entry.text\" placeholder=\"¿Qué sucedió hoy?\">\r\n      </textarea>\r\n    </div>\r\n\r\n      <img\r\n      v-if=\"entry.picture\"\r\n      :src=\"entry.picture\"\r\n      alt=\"entry-picture\"\r\n      class=\"img-thumbnail\"/>\r\n\r\n      <img\r\n      v-if=\"localImage\"\r\n      :src=\"localImage\"\r\n      alt=\"entry-picture\"\r\n      class=\"img-thumbnail\"/>\r\n\r\n  </template>\r\n\r\n  <Fab icon=\"fa-save\" @on:click=\"saveEntry\" />\r\n</template>\r\n\r\n\r\n\r\n<script>\r\nimport { defineAsyncComponent } from \"vue\";\r\nimport { mapGetters, mapActions } from \"vuex\";\r\nimport Swal from 'sweetalert2'\r\n\r\nimport getDayMonthYear from \"../helpers/getDayMonthYear\";\r\nimport uploadImage from \"../helpers/uploadImage\";\r\n\r\nexport default {\r\n  props: {\r\n    id: {\r\n      type: String,\r\n      required: true,\r\n    },\r\n  },\r\n  name: 'EntryView',\r\n  components: {\r\n    Fab: defineAsyncComponent(() => import(\"../components/Fab.vue\")),\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      entry: null,\r\n      localImage: null,\r\n      file: null\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    ...mapGetters(\"journal\", [\"getEntryById\"]),\r\n    day() {\r\n      const { day } = getDayMonthYear(this.entry.date);\r\n      return day;\r\n    },\r\n    month() {\r\n      const { month } = getDayMonthYear(this.entry.date);\r\n      return month;\r\n    },\r\n    yearDay() {\r\n      const { yearDay } = getDayMonthYear(this.entry.date);\r\n      return yearDay;\r\n    },\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions(\"journal\", [\"updateEntry\", \"createEntry\",\"deleteEntry\"]),\r\n\r\n    loadEntry() {\r\n      let entry;\r\n\r\n      if (this.id === \"new\") {\r\n        entry = {\r\n          text: \"\",\r\n          date: new Date().getTime(),\r\n        };\r\n      } else {\r\n        entry = this.getEntryById(this.id);\r\n        if (!entry) return this.$router.push({ name: \"no-entry\" });\r\n      }\r\n\r\n      this.entry = entry;\r\n    },\r\n\r\n    async saveEntry() {\r\n\r\n      Swal.fire({ //En las pruebas se le quitó el .fire y daba fallo no guardaba, TODO:\r\n        title: 'Espere por favor',\r\n        allowOutsideClick: false\r\n      })\r\n      \r\n      Swal.showLoading()\r\n\r\n      const picture = await uploadImage( this.file ) // cuando cargue, en el file tendremos el url de la imagen\r\n      \r\n      this.entry.picture = picture // va hacer igual que el picture de cloudinary\r\n\r\n      if (this.entry.id) {\r\n        //Actualizar\r\n        await this.updateEntry(this.entry);\r\n\r\n      } else {\r\n        // Crear una nueva entrada\r\n        const id = await this.createEntry(this.entry);\r\n\r\n        this.$router.push({ name: \"entry\", params: { id } });\r\n      }\r\n\r\n      this.file = null\r\n      Swal.fire('Guardado', 'Entrada registrada con éxito', 'success')\r\n\r\n    },\r\n\r\n    async onDeleteEntry() {\r\n      \r\n      const { isConfirmed } = await Swal.fire({\r\n          title: 'Está seguro?',\r\n          text: 'Una vez borrado, no se puede recuperar',\r\n          showDenyButton: true,\r\n          confirmButtonText: 'Sí, estoy seguro'\r\n      })\r\n\r\n\r\n      if ( isConfirmed ) {\r\n          Swal.fire({\r\n            title: 'Espere por favor',\r\n            allowOutsideClick: false\r\n          })\r\n        Swal.showLoading()\r\n\r\n        await this.deleteEntry( this.entry.id)\r\n        this.$router.push({ name: \"no-entry\"})\r\n\r\n        Swal.fire('Eliminado', '', 'success')\r\n      }\r\n\r\n    },\r\n    onSelectedImage( event ) {\r\n      const file = event.target.files[0]\r\n      if( !file ) {\r\n        this.localImage = null\r\n        this.file = null\r\n        return\r\n      } \r\n\r\n      this.file = file\r\n\r\n      const fr = new FileReader()\r\n      fr.onload = () => this.localImage = fr.result\r\n      fr.readAsDataURL( file )\r\n\r\n    },\r\n    onSelectImage() {\r\n      this.$refs.imageSelector.click() //busco el match selector y simulo el click\r\n    }\r\n  },\r\n\r\n  created() {\r\n    this.loadEntry();\r\n  },\r\n\r\n  watch: {\r\n    id() {\r\n      this.loadEntry();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\ntextarea {\r\n  font-size: 20px;\r\n  border: none;\r\n  height: 100%;\r\n  resize: none;\r\n\r\n  &:focus {\r\n    outline: none;\r\n  }\r\n\r\n  &::-webkit-scrollbar {\r\n    width: 5px;\r\n  }\r\n\r\n  &::-webkit-scrollbar-thumb {\r\n    background-color: grey; /* color of the scroll thumb */\r\n    border-radius: 20px; /* roundness of the scroll thumb */\r\n    border: 3px solid grey; /* creates padding around scroll thumb */\r\n  }\r\n}\r\n\r\nimg {\r\n  width: 200px;\r\n  position: fixed;\r\n  bottom: 150px;\r\n  right: 20px;\r\n  box-shadow: 0px 5px 10px rgba($color: #000000, $alpha: 0.2);\r\n}\r\n</style>","const months = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio','Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre']\r\nconst days   = ['Domingo','Lunes','Martes','Miércoles','Jueves','Viernes','Sábado']\r\n\r\nconst getDayMonthYear = ( dateString ) => {\r\n\r\n    const date = new Date( dateString )\r\n\r\n    return {\r\n        day: date.getDate(),\r\n        month: months[ date.getMonth() ],\r\n        yearDay: `${ date.getFullYear()}, ${ days[ date.getDay() ]}`,\r\n    }\r\n\r\n}\r\n\r\nexport default getDayMonthYear","import axios from 'axios'  // importar axios importante\r\n\r\nconst uploadImage = async ( file ) => {         //Necesito el file(el archivo a subir)\r\n    \r\n    if ( !file  ) return                // evaluar que si el archivo no existe se salga\r\n\r\n    try{\r\n\r\n        const formData = new FormData()                   //no se importa, viene propio de JS\r\n        formData.append('upload_preset','journal')  //journal o el valor que le hemos dado en cloudinary\r\n        formData.append('file', file)  // poner archivo que deseo subir y el archivo literalmente 'file'\r\n\r\n        const url = 'https://api.cloudinary.com/v1_1/ddn278n2q/image/upload' // url que probamos en postman\r\n        const {data} = await axios.post(url, formData) //mando el url y el formData que tenemos aquí\r\n\r\n        return data.secure_url\r\n\r\n    } catch ( error ) {\r\n        console.error('Error al cargar la imagen, revisar logs')\r\n        console.log(error)\r\n        return null\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default uploadImage // exportar para utilizar en otro archivo","import { render } from \"./EntryView.vue?vue&type=template&id=0dd55433&scoped=true\"\nimport script from \"./EntryView.vue?vue&type=script&lang=js\"\nexport * from \"./EntryView.vue?vue&type=script&lang=js\"\n\nimport \"./EntryView.vue?vue&type=style&index=0&id=0dd55433&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-0dd55433\"\n\nexport default script"],"sourceRoot":""}